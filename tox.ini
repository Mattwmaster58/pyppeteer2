[tox]
envlist = py3{6,7,8,8_xdist},flake8
minversion = 3.4.0

[testenv]
whitelist_external =
  poetry
  pytest
deps = py3{6,7,8,8_xdist}: -r requirements-test.txt
;skip_install = true
commands_pre:
  ; py3{6,7,8}: poetry run pyppeteer2-install
  py3{6,7,8}: pyppeteer2-install
commands =
  ;py3{6,7,8}: poetry run pytest --workers auto --tests-per-worker auto {posargs}
  py3{6,7,8}: pytest --workers auto {posargs}
  py38_xdist: pytest -n auto {posargs}

[testenv:flake8]
deps =
  flake8
  black
commands =
  flake8 ./
  black --check


[flake8]
max-line-length = 99
exclude = docs,.svn,CVS,.bzr,.hg,.git,__pycache__,.tox,.eggs,*.egg,out
max-complexity = 7

[pydocstyle]
ignore = D105,D107,D203,D213,D402,D404
match_dir = (?!(tmp|docs|ja_docs|tests|\.)).*

[pytest]
junit_suite_name: pyppeteer2 tests
junit_log_passing_tests: True
junit_family = xunit2
minversion = 5.0.0